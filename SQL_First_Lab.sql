USE LABS;

SELECT*
FROM applestore2;

/* QUESTION 1: Which are the different genres?*/

SELECT DISTINCT prime_genre
FROM applestore2;

/* QUESTION 2: Which is the genre with more apps rated?*/

SELECT
	prime_genre,
    COUNT(*) AS app_count
    FROM applestore2
    WHERE
    rating_count_tot>0
    GROUP BY prime_genre
    ORDER BY app_count DESC
    LIMIT 1;
    
/* QUESTION 3: Which is the genre with more apps?*/

SELECT
	prime_genre,
	COUNT(*) AS app_count
FROM applestore2
GROUP BY prime_genre
 ORDER BY app_count DESC
 LIMIT 1;
 
/* QUESTION 4: Which is the one with less?*/

select prime_genre,
count(*) as app_count
from applestore2
group by prime_genre
order by app_count asc
limit 1;

/* QUESTION 5: Take the 10 apps most rated.*/

select id, track_name, rating_count_tot
from applestore2
order by
rating_count_tot desc
limit 10;

/* QUESTION 6: Take the 10 apps best rated by users.*/

select id, track_name, user_rating
from applestore2
order by
user_rating desc
limit 10;

/* QUESTION 7: Take a look on the data you retrieved in the question 5. Give some insights.*/
  
  To find the most rated app, we have to pull the id, track_name, rating_count_tot column from the applestore table and arange rating_count_tot in decending order and keep the limit as 10 
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                 
/* QUESTION 8: Take a look on the data you retrieved in the question 6. Give some insights.*/

  To find the most rated app, we have to pull the id, track_name, user_rating column from the applestore table and arange user_rating in decending order and keep the limit as 10 

/* QUESTION 9: Now compare the data from questions 5 and 6. What do you see?*/

select 
    user_rating, 
    rating_count_tot,
    count(*) as num_count
from applestore2
group by user_rating, rating_count_tot
order by num_count desc;

/* QUESTION 10: How could you take the top 3 regarding the user ratings but also the number of votes?*/

select id, track_name, rating_count_tot, user_rating
from applestore2
order by
    user_rating DESC, 
    rating_count_tot DESC 
limit 3;
/* QUESTION 11: Does people care about the price? Do some queries, comment why are you doing them and the results you retrieve. What is your conclusion?*/

select id, track_name, price, user_rating, rating_count_tot
from 
    applestore2
order by 
    user_rating desc, 
    rating_count_tot desc 
limit 10;

/*Analysisi*/
select
count(*) as num_app,
avg(price) as avd_price,
min(price) as min_price,
max(price) as max_price
from applestore2

/*rating by pricing category*/
select case 
        when price = 0 then 'Free' 
        when price > 0 and price <= 1 then '0-1' 
        when price > 1 and price <= 5 then '1-5' 
        when price > 5 and price <= 10 then '5-10' 
        else '10+' 
    end as price_range,
    count(*) as num_apps,
    avg(user_rating) as avg_user_rating,
    sum(rating_count_tot) as total_votes
from applestore2
group by price_range
order by price_range;

